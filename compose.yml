services:
  chaptarr-mcp:
    #    image: docker.io/knucklessg1/arr-mcp:latest
    build:
      context: .
      dockerfile: debug.Dockerfile
    container_name: chaptarr-mcp
    hostname: chaptarr-mcp
    command: [ "chaptarr-mcp" ]
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - "${IP_DNS:-1.1.1.1}"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
    env_file:
      - .env
    environment:
      - "PYTHONUNBUFFERED=1"
      - "HOST=0.0.0.0"
      - "PORT=8060"
      - "TRANSPORT=streamable-http"
      - "CHAPTARR_BASE_URL=${CHAPTARR_BASE_URL:-http://chaptarr.arpa}"
      - "CHAPTARR_API_KEY=${CHAPTARR_API_KEY}"
      - "CHAPTARR_VERIFY=${CHAPTARR_VERIFY:-True}"
    ports:
      - "8060:8060"
    healthcheck:
      test: [ "CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8060/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  lidarr-mcp:
    #    image: docker.io/knucklessg1/arr-mcp:latest
    build:
      context: .
      dockerfile: debug.Dockerfile
    container_name: lidarr-mcp
    hostname: lidarr-mcp
    command: [ "lidarr-mcp" ]
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - "${IP_DNS:-1.1.1.1}"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
    env_file:
      - .env
    environment:
      - "PYTHONUNBUFFERED=1"
      - "HOST=0.0.0.0"
      - "PORT=8061"
      - "TRANSPORT=streamable-http"
      - "LIDARR_BASE_URL=${LIDARR_BASE_URL:-http://lidarr.arpa}"
      - "LIDARR_API_KEY=${LIDARR_API_KEY}"
      - "LIDARR_VERIFY=${LIDARR_VERIFY:-True}"
    ports:
      - "8061:8061"
    healthcheck:
      test: [ "CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8061/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  prowlarr-mcp:
    #    image: docker.io/knucklessg1/arr-mcp:latest
    build:
      context: .
      dockerfile: debug.Dockerfile
    container_name: prowlarr-mcp
    hostname: prowlarr-mcp
    command: [ "prowlarr-mcp" ]
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - "${IP_DNS:-1.1.1.1}"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
    env_file:
      - .env
    environment:
      - "PYTHONUNBUFFERED=1"
      - "HOST=0.0.0.0"
      - "PORT=8062"
      - "TRANSPORT=streamable-http"
      - "PROWLARR_BASE_URL=${PROWLARR_BASE_URL:-http://prowlarr.arpa}"
      - "PROWLARR_API_KEY=${PROWLARR_API_KEY}"
      - "PROWLARR_VERIFY=${PROWLARR_VERIFY:-True}"
    ports:
      - "8062:8062"
    healthcheck:
      test: [ "CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8062/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  radarr-mcp:
    #    image: docker.io/knucklessg1/arr-mcp:latest
    build:
      context: .
      dockerfile: debug.Dockerfile
    container_name: radarr-mcp
    hostname: radarr-mcp
    command: [ "radarr-mcp" ]
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - "${IP_DNS:-1.1.1.1}"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
    env_file:
      - .env
    environment:
      - "PYTHONUNBUFFERED=1"
      - "HOST=0.0.0.0"
      - "PORT=8063"
      - "TRANSPORT=streamable-http"
      - "RADARR_BASE_URL=${RADARR_BASE_URL:-http://radarr.arpa}"
      - "RADARR_API_KEY=${RADARR_API_KEY}"
      - "RADARR_VERIFY=${RADARR_VERIFY:-True}"
    ports:
      - "8063:8063"
    healthcheck:
      test: [ "CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8063/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  sonarr-mcp:
    #    image: docker.io/knucklessg1/arr-mcp:latest
    build:
      context: .
      dockerfile: debug.Dockerfile
    container_name: sonarr-mcp
    hostname: sonarr-mcp
    command: [ "sonarr-mcp" ]
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - "${IP_DNS:-1.1.1.1}"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
    env_file:
      - .env
    environment:
      - "PYTHONUNBUFFERED=1"
      - "HOST=0.0.0.0"
      - "PORT=8064"
      - "TRANSPORT=streamable-http"
      - "SONARR_BASE_URL=${SONARR_BASE_URL:-http://sonarr.arpa}"
      - "SONARR_API_KEY=${SONARR_API_KEY}"
      - "SONARR_VERIFY=${SONARR_VERIFY:-True}"
    ports:
      - "8064:8064"
    healthcheck:
      test: [ "CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8064/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  bazarr-mcp:
    #    image: docker.io/knucklessg1/arr-mcp:latest
    build:
      context: .
      dockerfile: debug.Dockerfile
    container_name: bazarr-mcp
    hostname: bazarr-mcp
    command: [ "bazarr-mcp" ]
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - "${IP_DNS:-1.1.1.1}"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
    env_file:
      - .env
    environment:
      - "PYTHONUNBUFFERED=1"
      - "HOST=0.0.0.0"
      - "PORT=8065"
      - "TRANSPORT=streamable-http"
      - "BAZARR_BASE_URL=${BAZARR_BASE_URL:-http://bazarr.arpa}"
      - "BAZARR_API_KEY=${BAZARR_API_KEY}"
      - "BAZARR_VERIFY=${BAZARR_VERIFY:-True}"
    ports:
      - "8065:8065"
    healthcheck:
      test: [ "CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8065/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  seerr-mcp:
    #    image: docker.io/knucklessg1/arr-mcp:latest
    build:
      context: .
      dockerfile: debug.Dockerfile
    container_name: seerr-mcp
    hostname: seerr-mcp
    command: [ "seerr-mcp" ]
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - "${IP_DNS:-1.1.1.1}"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
    env_file:
      - .env
    environment:
      - "PYTHONUNBUFFERED=1"
      - "HOST=0.0.0.0"
      - "PORT=8066"
      - "TRANSPORT=streamable-http"
      - "SEERR_BASE_URL=${SEERR_BASE_URL:-http://seerr.arpa}"
      - "SEERR_API_KEY=${SEERR_API_KEY}"
      - "SEERR_VERIFY=${SEERR_VERIFY:-True}"
    ports:
      - "8066:8066"
    healthcheck:
      test: [ "CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8066/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  arr-mcp:
    #    image: docker.io/knucklessg1/arr-mcp:latest
    build:
      context: .
      dockerfile: debug.Dockerfile
    container_name: arr-mcp
    hostname: arr-mcp
    command: [ "arr-mcp" ]
    depends_on:
      chaptarr-mcp:
        condition: service_healthy
      lidarr-mcp:
        condition: service_healthy
      sonarr-mcp:
        condition: service_healthy
      radarr-mcp:
        condition: service_healthy
      prowlarr-mcp:
        condition: service_healthy
      bazarr-mcp:
        condition: service_healthy
      seerr-mcp:
        condition: service_healthy
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - "${IP_DNS:-1.1.1.1}"
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
    env_file:
      - .env
    environment:
      - "PYTHONUNBUFFERED=1"
      - "HOST=0.0.0.0"
      - "PORT=8099"
      - "TRANSPORT=streamable-http"
      - "CHAPTARR_MCP_URL=${CHAPTARR_MCP_URL:-http://chaptarr-mcp:8060/mcp}"
      - "LIDARR_MCP_URL=${LIDARR_MCP_URL:-http://lidarr-mcp:8061/mcp}"
      - "PROWLARR_MCP_URL=${PROWLARR_MCP_URL:-http://prowlarr-mcp:8062/mcp}"
      - "RADARR_MCP_URL=${RADARR_MCP_URL:-http://radarr-mcp:8063/mcp}"
      - "SONARR_MCP_URL=${SONARR_MCP_URL:-http://sonarr-mcp:8064/mcp}"
      - "BAZARR_MCP_URL=${BAZARR_MCP_URL:-http://bazarr-mcp:8065/mcp}"
      - "SEERR_MCP_URL=${SEERR_MCP_URL:-http://seerr-mcp:8066/mcp}"
    ports:
      - "8099:8099"
    healthcheck:
      test: [ "CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8099/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  arr-agent:
    #    image: docker.io/knucklessg1/arr-mcp:latest
    build:
      context: .
      dockerfile: debug.Dockerfile
    container_name: arr-agent
    hostname: arr-agent
    command: [ "arr-agent" ]
    extra_hosts:
      - "host.docker.internal:host-gateway"
    dns:
      - "${IP_DNS:-1.1.1.1}"
    depends_on:
      arr-mcp:
        condition: service_healthy
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
    env_file:
      - .env
    environment:
      - "PYTHONUNBUFFERED=1"
      - "HOST=0.0.0.0"
      - "PORT=9099"
      - "MCP_URL=http://arr-mcp:8099/mcp"
      - "PROVIDER=openai"
      - "LLM_BASE_URL=${LLM_BASE_URL:-http://host.docker.internal:1234/v1}"
      - "LLM_API_KEY=${LLM_API_KEY:-llama}"
      - "MODEL_ID=${MODEL_ID:-qwen/qwen3-coder-next}"
      - "DEBUG=False"
      - "ENABLE_WEB_UI=True"
    ports:
      - "9099:9099"
    healthcheck:
      test: [ "CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:9099/health')" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
